library(plotly)
# Chunk 6
df <- psych::sai %>%
filter(time < 4) %>%
mutate(time = as.factor(time),
id = as.character(id)) %>%
select(time, relaxed, joyful, confident, anxious, worrying, upset)
report(df)
# Chunk 8
cor <- correlation(df)
knitr::kable(head(cor), digits=2)
# Chunk 10
cor %>%
report() %>%
to_table() %>%
knitr::kable()
p <- cor %>%
remove_triangular() %>%
ggplot(aes(x=Parameter1, y=Parameter2, fill=r)) +
geom_tile() +
scale_fill_gradient2(low = "#d50000", high = "#00C853") +
theme_minimal() +
theme(axis.title = element_blank())
ggplotly(p)
p <- cor %>%
filter(Parameter1 != Parameter2) %>%
ggplot(aes(x=Parameter1, y=r, fill=r)) +
geom_bar(stat="identity") +
scale_fill_gradient2(low = "#d50000", high = "#00C853") +
theme_minimal() +
theme(axis.title.x = element_blank()) +
facet_wrap(~Parameter2) +
coord_flip()
ggplotly(p)
p <- cor %>%
# filter(Parameter1 != Parameter2) %>%
remove_triangular() %>%
ggplot(aes(x=Parameter1, y=r, fill=r)) +
geom_bar(stat="identity") +
scale_fill_gradient2(low = "#d50000", high = "#00C853") +
theme_minimal() +
theme(axis.title.x = element_blank()) +
facet_wrap(~Parameter2) +
coord_flip()
ggplotly(p)
coord_radar <- function (theta = "x", start = 0, direction = 1)
{
theta <- match.arg(theta, c("x", "y"))
r <- if (theta == "x")
"y"
else "x"
ggproto("CordRadar", CoordPolar, theta = theta, r = r, start = start,
direction = sign(direction),
is_linear = function(coord) TRUE)
}
p <- cor %>%
ggplot(aes(x=Parameter1, y=r, group=Parameter2, fill=Parameter2)) +
geom_polygon(alpha=0.8, show.legend = FALSE) +
theme_minimal() +
theme(axis.title.x = element_blank()) +
facet_wrap(~Parameter2) +
coord_radar()
p
cor %>%
remove_triangular() %>%
as_tbl_graph() %>%
ggraph(layout = 'drl') +
geom_edge_arc(aes(colour=r), curvature=0.1) +
geom_node_point() +
geom_node_text(aes(label = name)) +
scale_edge_color_gradient2(low = "#d50000", high = "#00C853") +
theme_graph()
cor %>%
remove_triangular() %>%
as_tbl_graph() %>%
ggraph(layout = 'drl') +
geom_edge_arc(aes(colour=r), curvature=0.1) +
geom_node_point(colour="black", size=3) +
geom_node_text(aes(label = name)) +
scale_edge_color_gradient2(low = "#d50000", high = "#00C853") +
theme_graph()
cor %>%
remove_triangular() %>%
as_tbl_graph() %>%
ggraph(layout = 'drl') +
geom_edge_arc(aes(colour=r), curvature=0.1) +
geom_node_point(stroke="black", size=10) +
geom_node_text(aes(label = name)) +
scale_edge_color_gradient2(low = "#d50000", high = "#00C853") +
theme_graph()
cor %>%
remove_triangular() %>%
as_tbl_graph() %>%
ggraph(layout = 'drl') +
geom_edge_arc(aes(colour=r), curvature=0.1) +
geom_node_point(stroke=1, size=10) +
geom_node_text(aes(label = name)) +
scale_edge_color_gradient2(low = "#d50000", high = "#00C853") +
theme_graph()
cor %>%
remove_triangular() %>%
as_tbl_graph() %>%
ggraph(layout = 'drl') +
geom_edge_arc(aes(colour=r), curvature=0.1) +
geom_node_point(stroke=0.1, size=10) +
geom_node_text(aes(label = name)) +
scale_edge_color_gradient2(low = "#d50000", high = "#00C853") +
theme_graph()
cor %>%
remove_triangular() %>%
as_tbl_graph() %>%
ggraph(layout = 'drl') +
geom_edge_arc(aes(colour=r), curvature=0.1) +
geom_node_point(stroke=2, size=10) +
geom_node_text(aes(label = name)) +
scale_edge_color_gradient2(low = "#d50000", high = "#00C853") +
theme_graph()
cor %>%
remove_triangular() %>%
as_tbl_graph() %>%
ggraph(layout = 'drl') +
geom_edge_arc(aes(colour=r), curvature=0.1) +
geom_node_point(stroke=2, fill="white", size=10) +
geom_node_text(aes(label = name)) +
scale_edge_color_gradient2(low = "#d50000", high = "#00C853") +
theme_graph()
cor %>%
remove_triangular() %>%
as_tbl_graph() %>%
ggraph(layout = 'drl') +
geom_edge_arc(aes(colour=r), curvature=0.1) +
geom_node_point(stroke=0.1, fill="white", size=10) +
geom_node_text(aes(label = name)) +
scale_edge_color_gradient2(low = "#d50000", high = "#00C853") +
theme_graph()
cor %>%
remove_triangular() %>%
as_tbl_graph() %>%
ggraph(layout = 'drl') +
geom_edge_arc(aes(colour=r), curvature=0.1) +
geom_node_point(stroke=0.01, fill="white", size=10) +
geom_node_text(aes(label = name)) +
scale_edge_color_gradient2(low = "#d50000", high = "#00C853") +
theme_graph()
cor %>%
remove_triangular() %>%
as_tbl_graph() %>%
ggraph(layout = 'drl') +
geom_edge_arc(aes(colour=r), curvature=0.1) +
geom_node_point(stroke=0.01, fill="blue", size=10) +
geom_node_text(aes(label = name)) +
scale_edge_color_gradient2(low = "#d50000", high = "#00C853") +
theme_graph()
cor %>%
remove_triangular() %>%
as_tbl_graph() %>%
ggraph(layout = 'drl') +
geom_edge_arc(aes(colour=r), curvature=0.1) +
geom_node_point(fill="blue", size=10) +
geom_node_text(aes(label = name)) +
scale_edge_color_gradient2(low = "#d50000", high = "#00C853") +
theme_graph()
cor %>%
remove_triangular() %>%
as_tbl_graph() %>%
ggraph(layout = 'drl') +
geom_edge_arc(aes(colour=r), curvature=0.1) +
geom_node_point(color="blue", size=10) +
geom_node_text(aes(label = name)) +
scale_edge_color_gradient2(low = "#d50000", high = "#00C853") +
theme_graph()
cor %>%
remove_triangular() %>%
as_tbl_graph() %>%
ggraph(layout = 'drl') +
geom_edge_arc(aes(colour=r), curvature=0.1) +
geom_node_point(color="blue", size=10, stroke=0.1) +
geom_node_text(aes(label = name)) +
scale_edge_color_gradient2(low = "#d50000", high = "#00C853") +
theme_graph()
cor %>%
remove_triangular() %>%
as_tbl_graph() %>%
ggraph(layout = 'drl') +
geom_edge_arc(aes(colour=r), curvature=0.1) +
geom_node_point(color="blue", size=20, stroke=0.1) +
geom_node_text(aes(label = name)) +
scale_edge_color_gradient2(low = "#d50000", high = "#00C853") +
theme_graph()
cor %>%
remove_triangular() %>%
as_tbl_graph() %>%
ggraph(layout = 'drl') +
geom_edge_arc(aes(colour=r), curvature=0.1) +
geom_node_point(color="blue", size=20, stroke=0..5) +
geom_node_text(aes(label = name)) +
scale_edge_color_gradient2(low = "#d50000", high = "#00C853") +
theme_graph()
cor %>%
remove_triangular() %>%
as_tbl_graph() %>%
ggraph(layout = 'drl') +
geom_edge_arc(aes(colour=r), curvature=0.1) +
geom_node_point(color="blue", size=20, stroke=0.5) +
geom_node_text(aes(label = name)) +
scale_edge_color_gradient2(low = "#d50000", high = "#00C853") +
theme_graph()
cor %>%
remove_triangular() %>%
as_tbl_graph() %>%
ggraph(layout = 'drl') +
geom_edge_arc(aes(colour=r), curvature=0.1) +
geom_node_point(color="blue", size=20, stroke=0.5, fill="black") +
geom_node_text(aes(label = name)) +
scale_edge_color_gradient2(low = "#d50000", high = "#00C853") +
theme_graph()
cor %>%
remove_triangular() %>%
as_tbl_graph() %>%
ggraph(layout = 'drl') +
geom_edge_arc(aes(colour=r), curvature=0.1) +
geom_node_point(color="blue", size=20, stroke=5, fill="black") +
geom_node_text(aes(label = name)) +
scale_edge_color_gradient2(low = "#d50000", high = "#00C853") +
theme_graph()
cor %>%
remove_triangular() %>%
as_tbl_graph() %>%
ggraph(layout = 'drl') +
geom_edge_arc(aes(colour=r), curvature=0.1) +
geom_node_point(color="blue", size=20, stroke=10, fill="black") +
geom_node_text(aes(label = name)) +
scale_edge_color_gradient2(low = "#d50000", high = "#00C853") +
theme_graph()
cor %>%
remove_triangular() %>%
as_tbl_graph() %>%
ggraph(layout = 'drl') +
geom_edge_arc(aes(colour=r), curvature=0.1) +
geom_node_point(color="blue", size=20, stroke=10, fill="blue") +
geom_node_text(aes(label = name)) +
scale_edge_color_gradient2(low = "#d50000", high = "#00C853") +
theme_graph()
cor %>%
remove_triangular() %>%
as_tbl_graph() %>%
ggraph(layout = 'drl') +
geom_edge_arc(aes(colour=r), curvature=0.1) +
geom_node_point(color="black", size=20, stroke=10, fill="blue") +
geom_node_text(aes(label = name)) +
scale_edge_color_gradient2(low = "#d50000", high = "#00C853") +
theme_graph()
cor %>%
remove_triangular() %>%
as_tbl_graph() %>%
ggraph(layout = 'drl') +
geom_edge_arc(aes(colour=r), curvature=0.1) +
geom_node_point(color="black", size=20, stroke=0.1, fill="blue") +
geom_node_text(aes(label = name)) +
scale_edge_color_gradient2(low = "#d50000", high = "#00C853") +
theme_graph()
cor %>%
remove_triangular() %>%
as_tbl_graph() %>%
ggraph(layout = 'drl') +
geom_edge_arc(aes(colour=r), curvature=0.1) +
geom_node_point(color="white", size=20, stroke=0.1, fill="blue") +
geom_node_text(aes(label = name)) +
scale_edge_color_gradient2(low = "#d50000", high = "#00C853") +
theme_graph()
cor %>%
remove_triangular() %>%
as_tbl_graph() %>%
ggraph(layout = 'drl') +
geom_edge_arc(aes(colour=r), curvature=0.1) +
geom_node_point(color="white", size=20) +
geom_node_text(aes(label = name)) +
scale_edge_color_gradient2(low = "#d50000", high = "#00C853") +
theme_graph()
cor %>%
remove_triangular() %>%
as_tbl_graph() %>%
ggraph(layout = 'drl') +
geom_edge_arc(aes(colour=r), curvature=0.1) +
geom_node_point(color="#607D8B", size=20) +
geom_node_text(aes(label = name), colour="white") +
scale_edge_color_gradient2(low = "#d50000", high = "#00C853") +
theme_graph()
cor %>%
remove_triangular() %>%
as_tbl_graph() %>%
ggraph(layout = 'drl') +
geom_edge_arc(aes(colour=r), curvature=0.1) +
geom_node_point(color="#607D8B", size=22) +
geom_node_text(aes(label = name), colour="white") +
scale_edge_color_gradient2(low = "#d50000", high = "#00C853") +
theme_graph()
cor %>%
remove_triangular() %>%
as_tbl_graph() %>%
ggraph(layout = 'drl') +
geom_edge_arc(aes(colour=r), curvature=0.1, size=2) +
geom_node_point(color="#607D8B", size=22) +
geom_node_text(aes(label = name), colour="white") +
scale_edge_color_gradient2(low = "#d50000", high = "#00C853") +
theme_graph()
cor %>%
remove_triangular() %>%
as_tbl_graph() %>%
ggraph(layout = 'drl') +
geom_edge_arc(aes(colour=r), curvature=0.1, edge_size=2) +
geom_node_point(color="#607D8B", size=22) +
geom_node_text(aes(label = name), colour="white") +
scale_edge_color_gradient2(low = "#d50000", high = "#00C853") +
theme_graph()
cor %>%
remove_triangular() %>%
as_tbl_graph() %>%
ggraph(layout = 'drl') +
geom_edge_arc(aes(colour=r), curvature=0.1, edge_width=2) +
geom_node_point(color="#607D8B", size=22) +
geom_node_text(aes(label = name), colour="white") +
scale_edge_color_gradient2(low = "#d50000", high = "#00C853") +
theme_graph()
cor %>%
remove_triangular() %>%
as_tbl_graph() %>%
ggraph(layout = 'drl') +
geom_edge_arc(aes(colour=r), curvature=0.1, edge_width=1) +
geom_node_point(color="#607D8B", size=22) +
geom_node_text(aes(label = name), colour="white") +
scale_edge_color_gradient2(low = "#d50000", high = "#00C853") +
theme_graph()
cor %>%
remove_triangular() %>%
as_tbl_graph() %>%
ggraph(layout = 'drl') +
geom_edge_arc(aes(colour=r), curvature=0.1, edge_width=1) +
geom_node_point(color="#607D8B", size=22) +
geom_node_text(aes(label = name), colour="white") +
scale_edge_color_gradient2(low = "#d50000", high = "#00C853") +
theme_graph() +
expand_scale()
cor %>%
remove_triangular() %>%
as_tbl_graph() %>%
ggraph(layout = 'drl') +
geom_edge_arc(aes(colour=r), curvature=0.1, edge_width=1) +
geom_node_point(color="#607D8B", size=22) +
geom_node_text(aes(label = name), colour="white") +
scale_edge_color_gradient2(low = "#d50000", high = "#00C853") +
theme_graph() +
scale_x_continuous(expand = expand_scale(c(.10, .10))) +
scale_y_continuous(expand = expand_scale(c(.10, .10)))
set.seed(222)
cor %>%
remove_triangular() %>%
as_tbl_graph() %>%
ggraph(layout = 'drl') +
geom_edge_arc(aes(colour=r), curvature=0.1, edge_width=1) +
geom_node_point(color="#607D8B", size=22) +
geom_node_text(aes(label = name), colour="white") +
scale_edge_color_gradient2(low = "#d50000", high = "#00C853") +
theme_graph() +
scale_x_continuous(expand = expand_scale(c(.10, .10))) +
scale_y_continuous(expand = expand_scale(c(.10, .10)))
set.seed(222)
cor %>%
remove_triangular() %>%
as_tbl_graph() %>%
ggraph(layout = 'drl') +
geom_edge_arc(aes(colour=r), curvature=0.1, edge_width=1) +
geom_node_point(color="#607D8B", size=22) +
geom_node_text(aes(label = name), colour="white") +
scale_edge_color_gradient2(low = "#d50000", high = "#00C853") +
theme_graph() +
scale_x_continuous(expand = expand_scale(c(.10, .10))) +
scale_y_continuous(expand = expand_scale(c(.10, .10)))
set.seed(111)
cor %>%
remove_triangular() %>%
as_tbl_graph() %>%
ggraph(layout = 'drl') +
geom_edge_arc(aes(colour=r), curvature=0.1, edge_width=1) +
geom_node_point(color="#607D8B", size=22) +
geom_node_text(aes(label = name), colour="white") +
scale_edge_color_gradient2(low = "#d50000", high = "#00C853") +
theme_graph() +
scale_x_continuous(expand = expand_scale(c(.10, .10))) +
scale_y_continuous(expand = expand_scale(c(.10, .10)))
set.seed(999)
cor %>%
remove_triangular() %>%
as_tbl_graph() %>%
ggraph(layout = 'drl') +
geom_edge_arc(aes(colour=r), curvature=0.1, edge_width=1) +
geom_node_point(color="#607D8B", size=22) +
geom_node_text(aes(label = name), colour="white") +
scale_edge_color_gradient2(low = "#d50000", high = "#00C853") +
theme_graph() +
scale_x_continuous(expand = expand_scale(c(.10, .10))) +
scale_y_continuous(expand = expand_scale(c(.10, .10)))
set.seed(999)
cor %>%
remove_triangular() %>%
as_tbl_graph() %>%
ggraph(layout = 'drl') +
geom_edge_arc(aes(colour=r), curvature=0.1, edge_width=1) +
geom_node_point(color="#607D8B", size=22) +
geom_node_text(aes(label = name), colour="white") +
scale_edge_color_gradient2(low = "#d50000", high = "#00C853") +
theme_graph() +
scale_x_continuous(expand = expand_scale(c(.10, .10))) +
scale_y_continuous(expand = expand_scale(c(.10, .10)))
blogdown::serve_site()
blogdown::serve_site()
# Chunk 2
library(correlation)
# Chunk 4
library(report)
# Chunk 5
library(dplyr)
library(forcats)
library(psych)
library(ggplot2)
library(tidygraph)
library(ggraph)
library(plotly)
# Chunk 6
# Load the data
df <- psych::sai %>%
filter(time < 4) %>%
mutate(time = as.factor(time),
id = as.character(id)) %>%
select(time, relaxed, joyful, confident, anxious, worrying, upset)
# Report the data
report(df)
# Chunk 8
cor <- correlation(df)
knitr::kable(head(cor), digits=2)
# Chunk 10
cor %>%
report() %>%
to_table() %>%
knitr::kable()
# Chunk 11
p <- cor %>%
remove_triangular() %>%
ggplot(aes(x=Parameter1, y=Parameter2, fill=r)) +
geom_tile() +
scale_fill_gradient2(low = "#d50000", high = "#00C853") +
theme_minimal() +
theme(axis.title = element_blank())
ggplotly(p)
p <- cor %>%
filter(Parameter1 != Parameter2) %>%
ggplot(aes(x=Parameter1, y=r, fill=r)) +
geom_bar(stat="identity") +
scale_fill_gradient2(low = "#d50000", high = "#00C853") +
theme_minimal() +
theme(axis.title.x = element_blank()) +
facet_wrap(~Parameter2) +
theme_minimal()
ggplotly(p)
p <- cor %>%
filter(Parameter1 != Parameter2) %>%
ggplot(aes(x=Parameter1, y=r, fill=r)) +
geom_bar(stat="identity") +
scale_fill_gradient2(low = "#d50000", high = "#00C853") +
theme_minimal() +
theme(axis.title.x = element_blank()) +
facet_wrap(~Parameter2) +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggplotly(p)
p <- cor %>%
filter(Parameter1 != Parameter2) %>%
ggplot(aes(x=Parameter1, y=r, fill=r)) +
geom_bar(stat="identity") +
scale_fill_gradient2(low = "#d50000", high = "#00C853") +
theme_minimal() +
theme(axis.title.x = element_blank()) +
facet_wrap(~Parameter2) +
theme_minimal() +
theme(axis.title = element_blank(),
axis.text.x = element_text(angle = 45, hjust = 1))
ggplotly(p)
p <- cor %>%
filter(Parameter1 != Parameter2) %>%
ggplot(aes(x=Parameter1, y=r, fill=r)) +
geom_bar(stat="identity") +
scale_fill_gradient2(low = "#d50000", high = "#00C853") +
theme_minimal() +
theme(axis.title.x = element_blank()) +
facet_wrap(~Parameter2) +
theme_minimal() +
theme(axis.title.x = element_blank(),
axis.text.x = element_text(angle = 45, hjust = 1))
ggplotly(p)
blogdown::serve_site()
p <- cor %>%
remove_triangular() %>%
as_tbl_graph() %>%
ggraph(layout = 'drl') +
geom_edge_arc(aes(colour=r), curvature=0.1, edge_width=1) +
geom_node_point(color="#607D8B", size=22) +
geom_node_text(aes(label = name), colour="white") +
scale_edge_color_gradient2(low = "#d50000", high = "#00C853") +
theme_graph() +
scale_x_continuous(expand = expand_scale(c(.10, .10))) +
scale_y_continuous(expand = expand_scale(c(.10, .10)))
ggplotly(p)
